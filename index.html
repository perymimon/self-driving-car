<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>self driving car - world</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<canvas id="editorCanvas"></canvas>
<div id="controls">
    <button id="disposeButton">üóëÔ∏è clear</button>
    <button id="saveButton">üíæ save</button>
</div>
<script type="module">
    import Graph from './js/math/graph.js'
    import Point from "./js/primitives/point.js";
    import Segment from "./js/primitives/segment.js";
    import GraphEditor from "./js/graphEditor.js";
    import ViewPort from "./js/viewport.js";

    editorCanvas.width = 600
    editorCanvas.height = 600

    const ctx = editorCanvas.getContext('2d')

    // window.p1 = new Point(100, 100)
    // const p2 = new Point(200, 200)
    // const p3 = new Point(100, 200)
    // const p4 = new Point(0, 0)
    //
    // const s1 = new Segment(p1, p2)
    // const s3 = new Segment(p2, p3)

    const graphString = localStorage.getItem('graph')
    const graphInfo = graphString ? JSON.parse(graphString) : null

    // const graph = new Graph([p1, p2, p3, p4], [s1, s3])
    const graph = graphInfo ? Graph.Load(graphInfo) : new Graph()
    const viewPort = new ViewPort(editorCanvas)
    const graphEditor = new GraphEditor(viewPort, graph)

    animate()

    function animate() {
        viewPort.reset()
        graphEditor.display()

        requestAnimationFrame(animate)

    }

    document.getElementById('disposeButton').onclick = function dispose() {
        graphEditor.dispose()
    }


    document.getElementById('saveButton').onclick = function save() {
        localStorage.setItem('graph', JSON.stringify(graph))
    }
</script>
</body>
</html>